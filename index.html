<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>ff6ed40f002549ebab6c4c109aab3d84</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="503204f0" class="cell markdown" id="503204f0">
<h1 id="credit-card-fraud-detection">Credit Card Fraud Detection</h1>
<p>Summer 2025 Data Science Project<br />
Authors: Amelia Harn, Gitika Saravanan, Anika Rai</p>
<h2 id="contributions">Contributions</h2>
<ul>
<li><strong>A: Project idea</strong> — <strong><em>Amelia and
Gitika:</em></strong> Amelia came up with the topic idea and Gitika
found the credit card fraud dataset. We were both passionate about
discovering credit card fraud patterns.</li>
<li><strong>B: Dataset Curation and Preprocessing</strong> —
<strong><em>Amelia</em></strong> Moved dataset to be stored in Github
LFS system, cleaned up and structured data, completed entire dataset
curation and preprocessing section.</li>
<li><strong>C: Data Exploration and Summary Statistics</strong> —
<strong><em>Gitika and Anika</em></strong> Both Gitika and Anika
performed EDA, statistical tests, and created visualizations. Gitika
answered questions 1 and 2 in the EDA section, and Anika answered
questions 3 and 4.</li>
<li><strong>D: ML Algorithm Design/Development</strong> —
<strong><em>Anika</em></strong> Anika built and tuned ML classifiers for
fraud detection.</li>
<li><strong>E: ML Algorithm Training and Test Data Analysis</strong> —
<strong><em>Anika and Gitika</em></strong> Anika and Gitika evaluated
models and interpreted results.</li>
<li><strong>F: Visualization, Result Analysis, Conclusion</strong> —
<strong><em>Amelia and Gitika</em></strong> Amelia added on the random
forest model, and the last three ML visualizations. She created plots
and summaries, and Gitika wrote the conclusion.</li>
<li><strong>G: Final Tutorial Report Creation</strong> —
<strong><em>Amelia</em></strong> Organized and styled the notebook into
a readable GitHub tutorial.</li>
<li><strong>H: Additional</strong> — <strong><em>Gitika</em></strong>
Created Github repository.</li>
</ul>
</div>
<div id="b695892a" class="cell markdown" id="b695892a">
<h2 id="introduction"><strong>Introduction</strong></h2>
</div>
<div id="NBaEAzdDpc0R" class="cell markdown" id="NBaEAzdDpc0R">
<p>As our world becomes increasingly dependent on digital transactions,
the threat of credit card fraud is exponentially increasing. Financial
institutions face a lot of iternal and external pressure to detect and
prevent fraud in real time. In this project, we are using a large
transactional dataset to understand what characteristics are most
predictive of fraudulent behavior. Some of these inlcude merchant type,
transaction amount, customer demographics, and geographic indicators. By
examining these features, we hope to discover ways to enhance fraud
detection systems.</p>
<p>Our central research question is: To what extent can we predict the
likelihood of fraud based on transaction level features? We approach
this question through a combination of statistical inference and
supervised machine learning. First, we conduct a rigorous exploratory
data analysis, using hypothesis testing and visualization to identify
significant trends. Then, we implement different types of classification
models to evaluate the predictive power of multiple different
attributes. This work is important not only for improving fraud
reduction strategies but also for contributing to a broader
understanding of how data driven methods can tackle real world
challenges.</p>
</div>
<div id="3GRf9mJgo1xu" class="cell markdown" id="3GRf9mJgo1xu">
<h2 id="data-curation"><strong>Data Curation</strong></h2>
</div>
<div id="46a62f49" class="cell markdown" id="46a62f49">
<p>Our data is sourced from <a
href="https://huggingface.co/datasets/pointe77/credit-card-transaction">Hugging
Face</a>, and includes information about credit card transactions, with
features like credit card number, origin and location of the
transaction, and shopping category.</p>
</div>
<div id="691f92da" class="cell markdown" id="691f92da">
<h5 id="import-necessary-libraries"><strong><em>Import necessary
libraries</em></strong></h5>
</div>
<div id="a6d9e4f1" class="cell code" data-execution_count="3"
id="a6d9e4f1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span></code></pre></div>
</div>
<div id="7b885663" class="cell markdown" id="7b885663">
<h5 id="import-and-view-the-dataset-as-a-dataframe"><strong><em>Import
and view the dataset as a dataframe</em></strong></h5>
</div>
<div id="36c92f7e" class="cell code" data-execution_count="4"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:895}"
id="36c92f7e" data-outputId="c33422b0-0e6a-4a63-df37-83124514cf87">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load csv file into cct_data dataframe</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cct_data <span class="op">=</span> pd.read_csv(<span class="st">&#39;credit_card_transactions.csv&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dsplay number of rows and columns</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;(# of rows, # of columns): </span><span class="sc">{</span>cct_data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display data</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">&#39;display.max_columns&#39;</span>, <span class="va">None</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>display(cct_data)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(# of rows, # of columns): (1296675, 24)
</code></pre>
</div>
<div class="output display_data">

  <div id="df-05917f58-1e1d-46ff-be05-711aa4f27d00" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>trans_date_trans_time</th>
      <th>cc_num</th>
      <th>merchant</th>
      <th>category</th>
      <th>amt</th>
      <th>first</th>
      <th>last</th>
      <th>gender</th>
      <th>street</th>
      <th>city</th>
      <th>state</th>
      <th>zip</th>
      <th>lat</th>
      <th>long</th>
      <th>city_pop</th>
      <th>job</th>
      <th>dob</th>
      <th>trans_num</th>
      <th>unix_time</th>
      <th>merch_lat</th>
      <th>merch_long</th>
      <th>is_fraud</th>
      <th>merch_zipcode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2019-01-01 00:00:18</td>
      <td>2703186189652095</td>
      <td>fraud_Rippin, Kub and Mann</td>
      <td>misc_net</td>
      <td>4.97</td>
      <td>Jennifer</td>
      <td>Banks</td>
      <td>F</td>
      <td>561 Perry Cove</td>
      <td>Moravian Falls</td>
      <td>NC</td>
      <td>28654</td>
      <td>36.0788</td>
      <td>-81.1781</td>
      <td>3495</td>
      <td>Psychologist, counselling</td>
      <td>1988-03-09</td>
      <td>0b242abb623afc578575680df30655b9</td>
      <td>1325376018</td>
      <td>36.011293</td>
      <td>-82.048315</td>
      <td>0</td>
      <td>28705.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2019-01-01 00:00:44</td>
      <td>630423337322</td>
      <td>fraud_Heller, Gutmann and Zieme</td>
      <td>grocery_pos</td>
      <td>107.23</td>
      <td>Stephanie</td>
      <td>Gill</td>
      <td>F</td>
      <td>43039 Riley Greens Suite 393</td>
      <td>Orient</td>
      <td>WA</td>
      <td>99160</td>
      <td>48.8878</td>
      <td>-118.2105</td>
      <td>149</td>
      <td>Special educational needs teacher</td>
      <td>1978-06-21</td>
      <td>1f76529f8574734946361c461b024d99</td>
      <td>1325376044</td>
      <td>49.159047</td>
      <td>-118.186462</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2019-01-01 00:00:51</td>
      <td>38859492057661</td>
      <td>fraud_Lind-Buckridge</td>
      <td>entertainment</td>
      <td>220.11</td>
      <td>Edward</td>
      <td>Sanchez</td>
      <td>M</td>
      <td>594 White Dale Suite 530</td>
      <td>Malad City</td>
      <td>ID</td>
      <td>83252</td>
      <td>42.1808</td>
      <td>-112.2620</td>
      <td>4154</td>
      <td>Nature conservation officer</td>
      <td>1962-01-19</td>
      <td>a1a22d70485983eac12b5b88dad1cf95</td>
      <td>1325376051</td>
      <td>43.150704</td>
      <td>-112.154481</td>
      <td>0</td>
      <td>83236.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2019-01-01 00:01:16</td>
      <td>3534093764340240</td>
      <td>fraud_Kutch, Hermiston and Farrell</td>
      <td>gas_transport</td>
      <td>45.00</td>
      <td>Jeremy</td>
      <td>White</td>
      <td>M</td>
      <td>9443 Cynthia Court Apt. 038</td>
      <td>Boulder</td>
      <td>MT</td>
      <td>59632</td>
      <td>46.2306</td>
      <td>-112.1138</td>
      <td>1939</td>
      <td>Patent attorney</td>
      <td>1967-01-12</td>
      <td>6b849c168bdad6f867558c3793159a81</td>
      <td>1325376076</td>
      <td>47.034331</td>
      <td>-112.561071</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2019-01-01 00:03:06</td>
      <td>375534208663984</td>
      <td>fraud_Keeling-Crist</td>
      <td>misc_pos</td>
      <td>41.96</td>
      <td>Tyler</td>
      <td>Garcia</td>
      <td>M</td>
      <td>408 Bradley Rest</td>
      <td>Doe Hill</td>
      <td>VA</td>
      <td>24433</td>
      <td>38.4207</td>
      <td>-79.4629</td>
      <td>99</td>
      <td>Dance movement psychotherapist</td>
      <td>1986-03-28</td>
      <td>a41d7549acf90789359a9aa5346dcb46</td>
      <td>1325376186</td>
      <td>38.674999</td>
      <td>-78.632459</td>
      <td>0</td>
      <td>22844.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1296670</th>
      <td>1296670</td>
      <td>2020-06-21 12:12:08</td>
      <td>30263540414123</td>
      <td>fraud_Reichel Inc</td>
      <td>entertainment</td>
      <td>15.56</td>
      <td>Erik</td>
      <td>Patterson</td>
      <td>M</td>
      <td>162 Jessica Row Apt. 072</td>
      <td>Hatch</td>
      <td>UT</td>
      <td>84735</td>
      <td>37.7175</td>
      <td>-112.4777</td>
      <td>258</td>
      <td>Geoscientist</td>
      <td>1961-11-24</td>
      <td>440b587732da4dc1a6395aba5fb41669</td>
      <td>1371816728</td>
      <td>36.841266</td>
      <td>-111.690765</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1296671</th>
      <td>1296671</td>
      <td>2020-06-21 12:12:19</td>
      <td>6011149206456997</td>
      <td>fraud_Abernathy and Sons</td>
      <td>food_dining</td>
      <td>51.70</td>
      <td>Jeffrey</td>
      <td>White</td>
      <td>M</td>
      <td>8617 Holmes Terrace Suite 651</td>
      <td>Tuscarora</td>
      <td>MD</td>
      <td>21790</td>
      <td>39.2667</td>
      <td>-77.5101</td>
      <td>100</td>
      <td>Production assistant, television</td>
      <td>1979-12-11</td>
      <td>278000d2e0d2277d1de2f890067dcc0a</td>
      <td>1371816739</td>
      <td>38.906881</td>
      <td>-78.246528</td>
      <td>0</td>
      <td>22630.0</td>
    </tr>
    <tr>
      <th>1296672</th>
      <td>1296672</td>
      <td>2020-06-21 12:12:32</td>
      <td>3514865930894695</td>
      <td>fraud_Stiedemann Ltd</td>
      <td>food_dining</td>
      <td>105.93</td>
      <td>Christopher</td>
      <td>Castaneda</td>
      <td>M</td>
      <td>1632 Cohen Drive Suite 639</td>
      <td>High Rolls Mountain Park</td>
      <td>NM</td>
      <td>88325</td>
      <td>32.9396</td>
      <td>-105.8189</td>
      <td>899</td>
      <td>Naval architect</td>
      <td>1967-08-30</td>
      <td>483f52fe67fabef353d552c1e662974c</td>
      <td>1371816752</td>
      <td>33.619513</td>
      <td>-105.130529</td>
      <td>0</td>
      <td>88351.0</td>
    </tr>
    <tr>
      <th>1296673</th>
      <td>1296673</td>
      <td>2020-06-21 12:13:36</td>
      <td>2720012583106919</td>
      <td>fraud_Reinger, Weissnat and Strosin</td>
      <td>food_dining</td>
      <td>74.90</td>
      <td>Joseph</td>
      <td>Murray</td>
      <td>M</td>
      <td>42933 Ryan Underpass</td>
      <td>Manderson</td>
      <td>SD</td>
      <td>57756</td>
      <td>43.3526</td>
      <td>-102.5411</td>
      <td>1126</td>
      <td>Volunteer coordinator</td>
      <td>1980-08-18</td>
      <td>d667cdcbadaaed3da3f4020e83591c83</td>
      <td>1371816816</td>
      <td>42.788940</td>
      <td>-103.241160</td>
      <td>0</td>
      <td>69367.0</td>
    </tr>
    <tr>
      <th>1296674</th>
      <td>1296674</td>
      <td>2020-06-21 12:13:37</td>
      <td>4292902571056973207</td>
      <td>fraud_Langosh, Wintheiser and Hyatt</td>
      <td>food_dining</td>
      <td>4.30</td>
      <td>Jeffrey</td>
      <td>Smith</td>
      <td>M</td>
      <td>135 Joseph Mountains</td>
      <td>Sula</td>
      <td>MT</td>
      <td>59871</td>
      <td>45.8433</td>
      <td>-113.8748</td>
      <td>218</td>
      <td>Therapist, horticultural</td>
      <td>1995-08-16</td>
      <td>8f7c8e4ab7f25875d753b422917c98c9</td>
      <td>1371816817</td>
      <td>46.565983</td>
      <td>-114.186110</td>
      <td>0</td>
      <td>59870.0</td>
    </tr>
  </tbody>
</table>
<p>1296675 rows × 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-05917f58-1e1d-46ff-be05-711aa4f27d00')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-05917f58-1e1d-46ff-be05-711aa4f27d00 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-05917f58-1e1d-46ff-be05-711aa4f27d00');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4819d977-6581-4291-9b9c-805087a536d7">
      <button class="colab-df-quickchart" onclick="quickchart('df-4819d977-6581-4291-9b9c-805087a536d7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4819d977-6581-4291-9b9c-805087a536d7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_037b2202-2ee6-47d6-8007-438602fd27cc">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('cct_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_037b2202-2ee6-47d6-8007-438602fd27cc button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('cct_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div id="9c2634c1" class="cell markdown" id="9c2634c1">
<h5 id="parse-the-dataset"><strong><em>Parse the
dataset</em></strong></h5>
</div>
<div id="f71b6f89" class="cell code" data-execution_count="5"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="f71b6f89" data-outputId="d84dce0f-ed14-413f-a746-0cbb0e91fb60">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset types before processing</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Data types before processing:</span><span class="ch">\n\n</span><span class="sc">{</span>cct_data<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data types before processing:

Unnamed: 0                 int64
trans_date_trans_time     object
cc_num                     int64
merchant                  object
category                  object
amt                      float64
first                     object
last                      object
gender                    object
street                    object
city                      object
state                     object
zip                        int64
lat                      float64
long                     float64
city_pop                   int64
job                       object
dob                       object
trans_num                 object
unix_time                  int64
merch_lat                float64
merch_long               float64
is_fraud                   int64
merch_zipcode            float64
dtype: object
</code></pre>
</div>
</div>
<div id="a1baecbc" class="cell code" data-execution_count="6"
id="a1baecbc">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert date columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;trans_date_trans_time&#39;</span>] <span class="op">=</span> pd.to_datetime(cct_data[<span class="st">&#39;trans_date_trans_time&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;dob&#39;</span>] <span class="op">=</span> pd.to_datetime(cct_data[<span class="st">&#39;dob&#39;</span>], errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>)</span></code></pre></div>
</div>
<div id="adb20ee4" class="cell code" data-execution_count="7"
id="adb20ee4">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert below columns into categories</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> [<span class="st">&#39;gender&#39;</span>, <span class="st">&#39;category&#39;</span>, <span class="st">&#39;state&#39;</span>, <span class="st">&#39;job&#39;</span>, <span class="st">&#39;is_fraud&#39;</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    cct_data[col] <span class="op">=</span> cct_data[col].astype(<span class="st">&#39;category&#39;</span>)</span></code></pre></div>
</div>
<div id="6dd6909a" class="cell code" data-execution_count="8"
id="6dd6909a">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up zip codes and store them as strings</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;zip&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;zip&#39;</span>].astype(<span class="bu">str</span>).<span class="bu">str</span>.zfill(<span class="dv">5</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;merch_zipcode&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;merch_zipcode&#39;</span>].fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>).astype(<span class="bu">str</span>).<span class="bu">str</span>.zfill(<span class="dv">5</span>)</span></code></pre></div>
</div>
<div id="713397a1" class="cell code" data-execution_count="9"
id="713397a1">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert ids into strings</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;trans_num&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;trans_num&#39;</span>].astype(<span class="bu">str</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;cc_num&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;cc_num&#39;</span>].astype(<span class="bu">str</span>)</span></code></pre></div>
</div>
<div id="497c3d48" class="cell code" data-execution_count="10"
id="497c3d48">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create new columns for easy ML analysis in the future</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;age&#39;</span>] <span class="op">=</span> (cct_data[<span class="st">&#39;trans_date_trans_time&#39;</span>] <span class="op">-</span> cct_data[<span class="st">&#39;dob&#39;</span>]).dt.days <span class="op">//</span> <span class="dv">365</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;trans_hour&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;trans_date_trans_time&#39;</span>].dt.hour</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;trans_dayofweek&#39;</span>] <span class="op">=</span> cct_data[<span class="st">&#39;trans_date_trans_time&#39;</span>].dt.dayofweek</span></code></pre></div>
</div>
<div id="8560226d" class="cell code" data-execution_count="11"
id="8560226d">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop unneeded columns</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>drop_cols <span class="op">=</span> [<span class="st">&#39;Unnamed: 0&#39;</span>, <span class="st">&#39;cc_num&#39;</span>, <span class="st">&#39;first&#39;</span>, <span class="st">&#39;last&#39;</span>, <span class="st">&#39;street&#39;</span>, <span class="st">&#39;trans_num&#39;</span>, <span class="st">&#39;unix_time&#39;</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>cct_data <span class="op">=</span> cct_data.drop(columns<span class="op">=</span>drop_cols)</span></code></pre></div>
</div>
<div id="ac64199e" class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
id="ac64199e" data-outputId="4390feca-e91d-40a3-c0f0-d92760c24191">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display info</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Data types after processing:</span><span class="ch">\n\n</span><span class="sc">{</span>cct_data<span class="sc">.</span>dtypes<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss">(# of rows, # of columns): </span><span class="sc">{</span>cct_data<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>display(cct_data)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Data types after processing:

trans_date_trans_time    datetime64[ns]
merchant                         object
category                       category
amt                             float64
gender                         category
city                             object
state                          category
zip                              object
lat                             float64
long                            float64
city_pop                          int64
job                            category
dob                      datetime64[ns]
merch_lat                       float64
merch_long                      float64
is_fraud                       category
merch_zipcode                    object
age                               int64
trans_hour                        int32
trans_dayofweek                   int32
dtype: object

(# of rows, # of columns): (1296675, 20)
</code></pre>
</div>
<div class="output display_data">

  <div id="df-1953d701-d9b3-4fa3-878b-3f84a2f77708" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>trans_date_trans_time</th>
      <th>merchant</th>
      <th>category</th>
      <th>amt</th>
      <th>gender</th>
      <th>city</th>
      <th>state</th>
      <th>zip</th>
      <th>lat</th>
      <th>long</th>
      <th>city_pop</th>
      <th>job</th>
      <th>dob</th>
      <th>merch_lat</th>
      <th>merch_long</th>
      <th>is_fraud</th>
      <th>merch_zipcode</th>
      <th>age</th>
      <th>trans_hour</th>
      <th>trans_dayofweek</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2019-01-01 00:00:18</td>
      <td>fraud_Rippin, Kub and Mann</td>
      <td>misc_net</td>
      <td>4.97</td>
      <td>F</td>
      <td>Moravian Falls</td>
      <td>NC</td>
      <td>28654</td>
      <td>36.0788</td>
      <td>-81.1781</td>
      <td>3495</td>
      <td>Psychologist, counselling</td>
      <td>1988-03-09</td>
      <td>36.011293</td>
      <td>-82.048315</td>
      <td>0</td>
      <td>28705</td>
      <td>30</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2019-01-01 00:00:44</td>
      <td>fraud_Heller, Gutmann and Zieme</td>
      <td>grocery_pos</td>
      <td>107.23</td>
      <td>F</td>
      <td>Orient</td>
      <td>WA</td>
      <td>99160</td>
      <td>48.8878</td>
      <td>-118.2105</td>
      <td>149</td>
      <td>Special educational needs teacher</td>
      <td>1978-06-21</td>
      <td>49.159047</td>
      <td>-118.186462</td>
      <td>0</td>
      <td>00000</td>
      <td>40</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2019-01-01 00:00:51</td>
      <td>fraud_Lind-Buckridge</td>
      <td>entertainment</td>
      <td>220.11</td>
      <td>M</td>
      <td>Malad City</td>
      <td>ID</td>
      <td>83252</td>
      <td>42.1808</td>
      <td>-112.2620</td>
      <td>4154</td>
      <td>Nature conservation officer</td>
      <td>1962-01-19</td>
      <td>43.150704</td>
      <td>-112.154481</td>
      <td>0</td>
      <td>83236</td>
      <td>56</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2019-01-01 00:01:16</td>
      <td>fraud_Kutch, Hermiston and Farrell</td>
      <td>gas_transport</td>
      <td>45.00</td>
      <td>M</td>
      <td>Boulder</td>
      <td>MT</td>
      <td>59632</td>
      <td>46.2306</td>
      <td>-112.1138</td>
      <td>1939</td>
      <td>Patent attorney</td>
      <td>1967-01-12</td>
      <td>47.034331</td>
      <td>-112.561071</td>
      <td>0</td>
      <td>00000</td>
      <td>52</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-01-01 00:03:06</td>
      <td>fraud_Keeling-Crist</td>
      <td>misc_pos</td>
      <td>41.96</td>
      <td>M</td>
      <td>Doe Hill</td>
      <td>VA</td>
      <td>24433</td>
      <td>38.4207</td>
      <td>-79.4629</td>
      <td>99</td>
      <td>Dance movement psychotherapist</td>
      <td>1986-03-28</td>
      <td>38.674999</td>
      <td>-78.632459</td>
      <td>0</td>
      <td>22844</td>
      <td>32</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1296670</th>
      <td>2020-06-21 12:12:08</td>
      <td>fraud_Reichel Inc</td>
      <td>entertainment</td>
      <td>15.56</td>
      <td>M</td>
      <td>Hatch</td>
      <td>UT</td>
      <td>84735</td>
      <td>37.7175</td>
      <td>-112.4777</td>
      <td>258</td>
      <td>Geoscientist</td>
      <td>1961-11-24</td>
      <td>36.841266</td>
      <td>-111.690765</td>
      <td>0</td>
      <td>00000</td>
      <td>58</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1296671</th>
      <td>2020-06-21 12:12:19</td>
      <td>fraud_Abernathy and Sons</td>
      <td>food_dining</td>
      <td>51.70</td>
      <td>M</td>
      <td>Tuscarora</td>
      <td>MD</td>
      <td>21790</td>
      <td>39.2667</td>
      <td>-77.5101</td>
      <td>100</td>
      <td>Production assistant, television</td>
      <td>1979-12-11</td>
      <td>38.906881</td>
      <td>-78.246528</td>
      <td>0</td>
      <td>22630</td>
      <td>40</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1296672</th>
      <td>2020-06-21 12:12:32</td>
      <td>fraud_Stiedemann Ltd</td>
      <td>food_dining</td>
      <td>105.93</td>
      <td>M</td>
      <td>High Rolls Mountain Park</td>
      <td>NM</td>
      <td>88325</td>
      <td>32.9396</td>
      <td>-105.8189</td>
      <td>899</td>
      <td>Naval architect</td>
      <td>1967-08-30</td>
      <td>33.619513</td>
      <td>-105.130529</td>
      <td>0</td>
      <td>88351</td>
      <td>52</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1296673</th>
      <td>2020-06-21 12:13:36</td>
      <td>fraud_Reinger, Weissnat and Strosin</td>
      <td>food_dining</td>
      <td>74.90</td>
      <td>M</td>
      <td>Manderson</td>
      <td>SD</td>
      <td>57756</td>
      <td>43.3526</td>
      <td>-102.5411</td>
      <td>1126</td>
      <td>Volunteer coordinator</td>
      <td>1980-08-18</td>
      <td>42.788940</td>
      <td>-103.241160</td>
      <td>0</td>
      <td>69367</td>
      <td>39</td>
      <td>12</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1296674</th>
      <td>2020-06-21 12:13:37</td>
      <td>fraud_Langosh, Wintheiser and Hyatt</td>
      <td>food_dining</td>
      <td>4.30</td>
      <td>M</td>
      <td>Sula</td>
      <td>MT</td>
      <td>59871</td>
      <td>45.8433</td>
      <td>-113.8748</td>
      <td>218</td>
      <td>Therapist, horticultural</td>
      <td>1995-08-16</td>
      <td>46.565983</td>
      <td>-114.186110</td>
      <td>0</td>
      <td>59870</td>
      <td>24</td>
      <td>12</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
<p>1296675 rows × 20 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1953d701-d9b3-4fa3-878b-3f84a2f77708')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1953d701-d9b3-4fa3-878b-3f84a2f77708 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1953d701-d9b3-4fa3-878b-3f84a2f77708');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-710213e2-f9e9-476a-afbb-8bc986205aa6">
      <button class="colab-df-quickchart" onclick="quickchart('df-710213e2-f9e9-476a-afbb-8bc986205aa6')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-710213e2-f9e9-476a-afbb-8bc986205aa6 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_6373379f-befa-4385-84f6-c033d45331b6">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('cct_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6373379f-befa-4385-84f6-c033d45331b6 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('cct_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div id="7382490f" class="cell markdown" id="7382490f">
<h2 id="exploratory-data-analysis"><strong>Exploratory Data
Analysis</strong></h2>
</div>
<div id="4hv9lSJuu8tx" class="cell markdown" id="4hv9lSJuu8tx">
<p>We wanted to compare the number of fradulent and non-fraudulent
transactions. To accomplish this, we created a bar chart to visualize
the breakdown. We can see that fraudulent transactions comprise a very
small portion of total transactions.</p>
</div>
<div id="c664c06f" class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="c664c06f" data-outputId="98ee589f-aea5-4b58-9937-77d98eeed462">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cct_data[<span class="st">&#39;is_fraud&#39;</span>].value_counts().plot(kind<span class="op">=</span><span class="st">&#39;bar&#39;</span>, color<span class="op">=</span>[<span class="st">&#39;green&#39;</span>, <span class="st">&#39;red&#39;</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.xticks([<span class="dv">0</span>,<span class="dv">1</span>], [<span class="st">&#39;Non-Fraud&#39;</span>, <span class="st">&#39;Fraud&#39;</span>], rotation<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Fraud Distribution&#39;</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Fraud Occurrence&#39;</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/c87d1c1d6f5baec350d6a949a582fb29bbeb68b4.png" /></p>
</div>
</div>
<div id="uwN-OLW1xIoR" class="cell markdown" id="uwN-OLW1xIoR">
<p>We also wanted to know the distribution of purchase amounts in the
dataset. We created a histogram with the purchase amount plotted against
the frequency ('Full Transaction Amount Distribution'). However, since
the dataset was so large, it was difficult to understand what the most
prevalent purchase amounts were, since we could only see that majority
of transactions were between 0-2500. Thus, we created a secondary
histogram that zoomed in between the purchase range of 0-500. In
'Transaction Amount Distrubution (&lt;$500)', we can see that majority
of transactions lie between the 0-100 purchase range.</p>
</div>
<div id="cac829c8" class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:329}"
id="cac829c8" data-outputId="08a8ebef-efe3-4c6c-a2c0-fd2979e3442a">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>upper <span class="op">=</span> cct_data[<span class="st">&#39;amt&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>edges <span class="op">=</span> np.arange(<span class="dv">0</span>, upper <span class="op">+</span> <span class="dv">100</span>, <span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">5</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>sns.histplot(cct_data[<span class="st">&#39;amt&#39;</span>], bins<span class="op">=</span>edges, kde<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">0</span>])</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_title(<span class="st">&#39;Full Transaction Amount Distribution&#39;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_xlabel(<span class="st">&#39;Amount&#39;</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>].set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>sns.histplot(cct_data[<span class="st">&#39;amt&#39;</span>], bins<span class="op">=</span>np.arange(<span class="dv">0</span>, <span class="dv">500</span> <span class="op">+</span> <span class="dv">100</span>, <span class="dv">100</span>), kde<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>axes[<span class="dv">1</span>])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlim(<span class="dv">0</span>, <span class="dv">500</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_title(<span class="st">&#39;Transaction Amount Distribution (&lt; $500)&#39;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_xlabel(<span class="st">&#39;Amount&#39;</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>].set_ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/2997c2768beae83f4f02e5e1a5b3ee9e13086548.png" /></p>
</div>
</div>
<div id="jalx58rq_SoD" class="cell markdown" id="jalx58rq_SoD">
<p>We also visualized the distribution of transactions amounts by fraud
status using a boxplot. Most legitimate transactions are concentrated
around a lower purchase amount, but outliers are very common. With
fraudulent transactions, we can see a higher median transaction amount,
indicating that fraud occurs at a higher purchase amount than
non-fraudulent transactions. The fraud boxplot has fewer extreme
outliers, indicating that fraudulent transaction amounts tend to cluster
more tightly within a certain range.</p>
</div>
<div id="695edbf7" class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:366}"
id="695edbf7" data-outputId="2b416b5c-a515-45f2-93e7-c9b780ae53c5">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sns.boxplot(y<span class="op">=</span><span class="st">&#39;is_fraud&#39;</span>, x<span class="op">=</span><span class="st">&#39;amt&#39;</span>, data<span class="op">=</span>cct_data, orient<span class="op">=</span><span class="st">&#39;h&#39;</span>, showfliers<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Transaction Amounts by Fraud Status&#39;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Is Fraud&#39;</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Transaction Amount&#39;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.yticks([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="st">&#39;Non-Fraud&#39;</span>, <span class="st">&#39;Fraud&#39;</span>])</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/e795c1b514002d0f36841363747323f7747732b5.png" /></p>
</div>
</div>
<div id="T-le7IttksNo" class="cell markdown" id="T-le7IttksNo">
<p>QUESTION #1: Are some merchant categories disproportionately
fraudulent?<br />
Statistical method: Chi‑square test of independence
(categorical × categorical)<br />
Plot: Horizontal bar plot of fraud rate by category (top N
categories)</p>
</div>
<div id="4cf7fe9a" class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:519}"
id="4cf7fe9a" data-outputId="20a7918a-74b0-4687-d585-822bd80e1baf">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cross_tab<span class="op">=</span>pd.crosstab(cct_data[<span class="st">&#39;category&#39;</span>], cct_data[<span class="st">&#39;is_fraud&#39;</span>])</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>display(cross_tab)</span></code></pre></div>
<div class="output display_data">

  <div id="df-a97d971a-a061-4aa6-853e-476ce540cff5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>is_fraud</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>category</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>entertainment</th>
      <td>93781</td>
      <td>233</td>
    </tr>
    <tr>
      <th>food_dining</th>
      <td>91310</td>
      <td>151</td>
    </tr>
    <tr>
      <th>gas_transport</th>
      <td>131041</td>
      <td>618</td>
    </tr>
    <tr>
      <th>grocery_net</th>
      <td>45318</td>
      <td>134</td>
    </tr>
    <tr>
      <th>grocery_pos</th>
      <td>121895</td>
      <td>1743</td>
    </tr>
    <tr>
      <th>health_fitness</th>
      <td>85746</td>
      <td>133</td>
    </tr>
    <tr>
      <th>home</th>
      <td>122917</td>
      <td>198</td>
    </tr>
    <tr>
      <th>kids_pets</th>
      <td>112796</td>
      <td>239</td>
    </tr>
    <tr>
      <th>misc_net</th>
      <td>62372</td>
      <td>915</td>
    </tr>
    <tr>
      <th>misc_pos</th>
      <td>79405</td>
      <td>250</td>
    </tr>
    <tr>
      <th>personal_care</th>
      <td>90538</td>
      <td>220</td>
    </tr>
    <tr>
      <th>shopping_net</th>
      <td>95830</td>
      <td>1713</td>
    </tr>
    <tr>
      <th>shopping_pos</th>
      <td>115829</td>
      <td>843</td>
    </tr>
    <tr>
      <th>travel</th>
      <td>40391</td>
      <td>116</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a97d971a-a061-4aa6-853e-476ce540cff5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a97d971a-a061-4aa6-853e-476ce540cff5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a97d971a-a061-4aa6-853e-476ce540cff5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a287ad84-1c71-4a01-8149-0112303a3e74">
      <button class="colab-df-quickchart" onclick="quickchart('df-a287ad84-1c71-4a01-8149-0112303a3e74')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a287ad84-1c71-4a01-8149-0112303a3e74 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_7dfea07a-bc8c-460b-b9b5-16216c59f26a">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('cross_tab')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_7dfea07a-bc8c-460b-b9b5-16216c59f26a button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('cross_tab');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div id="825112a3" class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="825112a3" data-outputId="3e425039-f65d-4d60-dcf7-e2f761bcfdbd">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>chi2, p, dof, expected <span class="op">=</span> stats.chi2_contingency(cross_tab)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Chi-Square Statistic: </span><span class="sc">{</span>chi2<span class="sc">}</span><span class="ch">\n</span><span class="ss">P-value: </span><span class="sc">{</span>p<span class="sc">}</span><span class="ch">\n</span><span class="ss">Degrees of Freedom: </span><span class="sc">{</span>dof<span class="sc">}</span><span class="ch">\n</span><span class="ss">Expected Frequencies:</span><span class="ch">\n</span><span class="ss"> </span><span class="sc">{</span>expected<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Chi-Square Statistic: 6486.003269983207
P-value: 0.0
Degrees of Freedom: 13
Expected Frequencies:
 [[ 93469.78569495    544.21430505]
 [ 90931.56412285    529.43587715]
 [130896.87190005    762.12809995]
 [ 45188.89420094    263.10579906]
 [122922.30267569    715.69732431]
 [ 85381.87637689    497.12362311]
 [122402.33014055    712.66985945]
 [112380.67975013    654.32024987]
 [ 62920.65359708    366.34640292]
 [ 79193.90494534    461.09505466]
 [ 90232.63354503    525.36645497]
 [ 96978.35754295    564.64245705]
 [115996.62642374    675.37357626]
 [ 40272.51908381    234.48091619]]
</code></pre>
</div>
</div>
<div id="7d1da6b1" class="cell markdown" id="7d1da6b1">
<p>After conducting the Chi-Square Test, we found p &lt;0.001. Since the
p-value is less than our chosen significance level, we can reject the
null hypothesis. Shown below are the 10 merchant categories with the
highest number of fraudulent transactions.</p>
</div>
<div id="81bfda92" class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:814}"
id="81bfda92" data-outputId="e8326101-a563-44e3-e016-726068d27063">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fraud_counts <span class="op">=</span> cct_data[cct_data[<span class="st">&#39;is_fraud&#39;</span>] <span class="op">==</span> <span class="dv">1</span>].groupby(<span class="st">&#39;category&#39;</span>).size()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>fraud_counts <span class="op">=</span> fraud_counts.sort_values(ascending<span class="op">=</span><span class="va">False</span>).head(<span class="dv">10</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>plt.pie(fraud_counts, labels<span class="op">=</span>fraud_counts.index, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>, startangle<span class="op">=</span><span class="dv">140</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Distribution of Total Fraudulent Transactions by Category&#39;</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/tmp/ipython-input-18-3906514547.py:1: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
  fraud_counts = cct_data[cct_data[&#39;is_fraud&#39;] == 1].groupby(&#39;category&#39;).size()
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/8e8b274be83b281931c434b92a068833ecca7748.png" /></p>
</div>
</div>
<div id="6a15e828" class="cell markdown" id="6a15e828">
<p>Next, we can take a look at the standardized residuals of the
expected values. The expected values array from above are the counts of
expected fraudulent and non-fraudulent transactions if fraud were
equally likely across all merchants (i.e. if there was no association
between merchant category and presence of fraud).</p>
</div>
<div id="f7d0f562" class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="f7d0f562" data-outputId="edbbbfd6-35a1-4bca-a990-c0275e7d298e">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>observed <span class="op">=</span> cross_tab.values</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>residuals <span class="op">=</span> (observed <span class="op">-</span> expected) <span class="op">/</span> (expected <span class="op">**</span> <span class="fl">0.5</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">Standardized residuals:</span><span class="ch">\n</span><span class="st">&quot;</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      pd.DataFrame(residuals,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                   index<span class="op">=</span>cross_tab.index,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                   columns<span class="op">=</span>cross_tab.columns))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>
Standardized residuals:
 is_fraud               0          1
category                           
entertainment   1.017944 -13.340576
food_dining     1.254975 -16.446959
gas_transport   0.398368  -5.220771
grocery_net     0.607337  -7.959404
grocery_pos    -2.930104  38.400221
health_fitness  1.246138 -16.331146
home            1.471072 -19.279002
kids_pets       1.238903 -16.236332
misc_net       -2.187266  28.665021
misc_pos        0.750122  -9.830663
personal_care   1.016575 -13.322636
shopping_net   -3.687565  48.327059
shopping_pos   -0.492175   6.450159
travel          0.590397  -7.737393
</code></pre>
</div>
</div>
<div id="09d3f81b" class="cell markdown" id="09d3f81b">
<p>How do we interpret these results? If the residual value is greater
than 2, then the observed frequency is greater than the expected
frequency. If the residual value is less than -2, then the observed
frequency is less than the expected frequency. Thus, we can take special
interest in shopping_net, grocery_pos, and misc_net as the most
fraud-prone categories.</p>
</div>
<div id="dHdk4100kxyi" class="cell markdown" id="dHdk4100kxyi">
<p>QUESTION #2: Do men and women spend different amounts on
average?<br />
Statistical method: Welch’s two‑sample t‑test and non‑parametric
Mann‑Whitney test</p>
</div>
<div id="4YGFa9hoEWww" class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:507}"
id="4YGFa9hoEWww" data-outputId="e472f069-9d3c-4e14-ec94-34c153c6fa1f">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ttest_ind, mannwhitneyu</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># drop nan values in gender and amt</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>df_gender <span class="op">=</span> cct_data[[<span class="st">&#39;gender&#39;</span>, <span class="st">&#39;amt&#39;</span>]].dropna()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># log-transform to stabilize any variance</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>df_gender[<span class="st">&#39;log_amt&#39;</span>] <span class="op">=</span> np.log1p(df_gender[<span class="st">&#39;amt&#39;</span>])</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># run a welch&#39;s two sample t-test (which assumes unequal variances)</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>male_amt <span class="op">=</span> df_gender[df_gender[<span class="st">&#39;gender&#39;</span>] <span class="op">==</span> <span class="st">&#39;M&#39;</span>][<span class="st">&#39;amt&#39;</span>]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>female_amt <span class="op">=</span> df_gender[df_gender[<span class="st">&#39;gender&#39;</span>] <span class="op">==</span> <span class="st">&#39;F&#39;</span>][<span class="st">&#39;amt&#39;</span>]</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>t_stat, t_pval <span class="op">=</span> ttest_ind(male_amt, female_amt, equal_var<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># run a mann-whitney u test</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>u_stat, u_pval <span class="op">=</span> mannwhitneyu(male_amt, female_amt, alternative<span class="op">=</span><span class="st">&#39;two-sided&#39;</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Welch&#39;s t-test p-value: </span><span class="sc">{</span>t_pval<span class="sc">:.5f}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Mann-Whitney U p-value: </span><span class="sc">{</span>u_pval<span class="sc">:.5f}</span><span class="ss">&quot;</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plot violin plots tests</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>sns.violinplot(data<span class="op">=</span>df_gender, x<span class="op">=</span><span class="st">&#39;gender&#39;</span>, y<span class="op">=</span><span class="st">&#39;log_amt&#39;</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Spending Amount by Gender (Log-Scaled)&quot;</span>)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Spending Amount (Log-Scaled)&quot;</span>)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Gender&quot;</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Welch&#39;s t-test p-value: 0.24105
Mann-Whitney U p-value: 0.00000
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/49b1a87efa683813b113437c4232b42fe4569b1c.png" /></p>
</div>
</div>
<div id="oIrav1MLHPDR" class="cell markdown" id="oIrav1MLHPDR">
<p>The analysis comparing spending amounts between men and women yields
different results depending on the statistical test used. Welch’s
two-sample t-test, which assumes unequal variances and approximately
normal distributions, returned a p-value of 0.241 This suggests that
there is no statistical significantly difference in the average amount
spent by gender. However, the Mann-Whitney U test gave a p-value near 0,
which indicates a significant difference in the distributions of
spending between men and women. This discrepancy shows the importance of
test selection. Though the t-test focuses solely on differences in means
under specific assumptions, the Mann-Whitney test is better suited for
non-normal and skewed distributions. These are very common
characteristics in financial transaction data. The violin plot supports
this, showing that women tend to have a wider range of spending amounts
with a heavier upper tail. On the other hand, men's spending is more
concentrated around the median. The Mann-Whitney result is therefore
more reliable, which suggests that men and women do spend differently
even though their averages appear similar.</p>
</div>
<div id="IGVQW0ylJ3UM" class="cell markdown" id="IGVQW0ylJ3UM">
<p>QUESTION #3: How does amount relate to city population?<br />
Statistical method: Spearman or Pearson correlation + a p‑value
test<br />
Plot: 2D histogram heat map (with log_scale=True) using
sns.histplot()</p>
</div>
<div id="mIS7PZ62J-aQ" class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:511}"
id="mIS7PZ62J-aQ" data-outputId="28d04cd4-1d6f-4150-e8ea-95f586fe1bd7">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> spearmanr, pearsonr</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># drop nan values in city population and amt</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>df_city <span class="op">=</span> cct_data[[<span class="st">&#39;city_pop&#39;</span>, <span class="st">&#39;amt&#39;</span>]].dropna()</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co"># log-transform</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>df_city[<span class="st">&#39;log_amt&#39;</span>] <span class="op">=</span> np.log1p(df_city[<span class="st">&#39;amt&#39;</span>])</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>df_city[<span class="st">&#39;log_city_pop&#39;</span>] <span class="op">=</span> np.log1p(df_city[<span class="st">&#39;city_pop&#39;</span>])</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># run a pearson correlation</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>pearson_corr, pearson_pval <span class="op">=</span> pearsonr(df_city[<span class="st">&#39;city_pop&#39;</span>], df_city[<span class="st">&#39;amt&#39;</span>])</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># run a spearman correlation</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>spearman_corr, spearman_pval <span class="op">=</span> spearmanr(df_city[<span class="st">&#39;city_pop&#39;</span>], df_city[<span class="st">&#39;amt&#39;</span>])</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Pearson correlation: </span><span class="sc">{</span>pearson_corr<span class="sc">:.4f}</span><span class="ss">, p-value: </span><span class="sc">{</span>pearson_pval<span class="sc">:.5f}</span><span class="ss">&quot;</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Spearman correlation: </span><span class="sc">{</span>spearman_corr<span class="sc">:.4f}</span><span class="ss">, p-value: </span><span class="sc">{</span>spearman_pval<span class="sc">:.5f}</span><span class="ss">&quot;</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plot 2D histogram</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df_city, x<span class="op">=</span><span class="st">&#39;city_pop&#39;</span>, y<span class="op">=</span><span class="st">&#39;amt&#39;</span>, bins<span class="op">=</span><span class="dv">50</span>, log_scale<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&quot;viridis&quot;</span>)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Transaction Amount vs. City Population&quot;</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;City Population&quot;</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Transaction Amount&quot;</span>)</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Pearson correlation: 0.0058, p-value: 0.00000
Spearman correlation: -0.0236, p-value: 0.00000
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/5f6812ecf440bdfb1a498aeb8ce4e546e83cd26b.png" /></p>
</div>
</div>
<div id="afPshcVeLIGC" class="cell markdown" id="afPshcVeLIGC">
<p>The analysis is exploring the relationship between transaction amount
and city population. It reveals no meaningful correlation regardless of
the statistically significant p-values. The pearson correlation
coefficient is 0.0058, which means there is very little linear
relationship between the two variables. The Spearman correlation
coefficient is -0.0236, meaning there is very little monotonic
association too. Both tests have p-values close to zero but this
significance is probably due to the large size of the dataset rather
than any actual statistical significance. The histogram supports this
conclusion because it shows no clear trend linking the spending amount
and the city population. The most dense activity happens in the middle
of the range for both variables but there is no increase or decrease in
said activity. Therefore, thought the results are statistically
significant, transaction amount and city population are generally
uncorrelated in this dataset.</p>
</div>
<div id="mOBvFMQ7RO_G" class="cell markdown" id="mOBvFMQ7RO_G">
<p>QUESTION #4: How does average transaction amount vary across
different age groups?<br />
Statistical method: One-way ANOVA comparing means across age bins.<br />
Plot: Box plot of transaction amount across age bins (log-scaled,
labeled)</p>
</div>
<div id="hfEZTsjpRZeh" class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:489}"
id="hfEZTsjpRZeh" data-outputId="cb39e785-71d1-42ef-d67b-f1447b975228">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> f_oneway</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># drop unneeded columns (age and amount)</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>df_age <span class="op">=</span> cct_data[[<span class="st">&#39;age&#39;</span>, <span class="st">&#39;amt&#39;</span>]].dropna()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># make bins for age</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">25</span>, <span class="dv">35</span>, <span class="dv">45</span>, <span class="dv">55</span>, <span class="dv">65</span>, <span class="dv">100</span>]</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;&lt;18&#39;</span>, <span class="st">&#39;18–24&#39;</span>, <span class="st">&#39;25–34&#39;</span>, <span class="st">&#39;35–44&#39;</span>, <span class="st">&#39;45–54&#39;</span>, <span class="st">&#39;55–64&#39;</span>, <span class="st">&#39;65+&#39;</span>]</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>df_age[<span class="st">&#39;age_group&#39;</span>] <span class="op">=</span> pd.cut(df_age[<span class="st">&#39;age&#39;</span>], bins<span class="op">=</span>bins, labels<span class="op">=</span>labels, right<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co"># log transform the transaction amount</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>df_age[<span class="st">&#39;log_amt&#39;</span>] <span class="op">=</span> np.log1p(df_age[<span class="st">&#39;amt&#39;</span>])</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># group the spending amounts by age</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>grouped_amts <span class="op">=</span> df_age.groupby(<span class="st">&#39;age_group&#39;</span>, observed<span class="op">=</span><span class="va">True</span>)[<span class="st">&#39;amt&#39;</span>].<span class="bu">apply</span>(<span class="bu">list</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># run a one-way ANOVA</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>anova_stat, anova_pval <span class="op">=</span> f_oneway(<span class="op">*</span>grouped_amts)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;One-way ANOVA p-value: </span><span class="sc">{</span>anova_pval<span class="sc">:.5f}</span><span class="ss">&quot;</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># make a box plot</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>sns.boxplot(data<span class="op">=</span>df_age, x<span class="op">=</span><span class="st">&#39;age_group&#39;</span>, y<span class="op">=</span><span class="st">&#39;log_amt&#39;</span>)</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Log-Scaled Transaction Amount by Age Group&quot;</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Age Group&quot;</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Spending Amount (Log-Scaled)&quot;</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>One-way ANOVA p-value: 0.00000
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/30c472afd33e938e67326b29435e624fd895ff06.png" /></p>
</div>
</div>
<div id="tqHGXVvrSKLv" class="cell markdown" id="tqHGXVvrSKLv">
<p>This analysis shows that there is a statistically significant
difference in the average transcation amount across age groups. The
p-value of the one way ANOVA test of 0.00000 shows that we can
confidently reject the hypothesis that all age groups spend the same
amount on average. The box plot (which is log scaled) shows that the
overall shape of spending distributions is similar across different ages
but certain groups (25-44) show a slightly higher median spending and
more larger outliers. This suggests that age does influence spending
behavior and middle-aged customers potentially have larger transactions
on average compared to younger or older customers.</p>
</div>
<div id="e8zlOC1XoCoE" class="cell markdown" id="e8zlOC1XoCoE">
<h2 id="machine-learning-analysis"><strong>Machine Learning
Analysis</strong></h2>
</div>
<div id="VBp89nWvqdaa" class="cell markdown" id="VBp89nWvqdaa">
<p>Our objective in this machine learning analysis is to evaluate
whether transaction-level features (like merchant category, amount,
customer demographics, and time data) can predict whether a transaction
is fraudulent (is_fraud). To do this, we apply supervised machine
learning classification algorithms and compare the performance of two
models: Logistic Regression, a linear baseline, and Naive Bayes, a fast
probabilistic classifier that assumes feature independence. This
comparison allows us to explore both the trade-offs and the potential of
simple models when applied to imbalanced and real-world datasets like
fraud detection.</p>
</div>
<div id="Uz-vsOtLqth6" class="cell code" data-execution_count="23"
id="Uz-vsOtLqth6">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.compose <span class="im">import</span> ColumnTransformer</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, roc_auc_score</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># drop rows with any missing data</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>df_ml <span class="op">=</span> cct_data.dropna(subset<span class="op">=</span>[<span class="st">&#39;is_fraud&#39;</span>, <span class="st">&#39;amt&#39;</span>, <span class="st">&#39;category&#39;</span>, <span class="st">&#39;gender&#39;</span>, <span class="st">&#39;age&#39;</span>])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># targets and features</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df_ml.drop(columns<span class="op">=</span>[<span class="st">&#39;is_fraud&#39;</span>, <span class="st">&#39;trans_date_trans_time&#39;</span>, <span class="st">&#39;dob&#39;</span>])</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df_ml[<span class="st">&#39;is_fraud&#39;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># feature types</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>categorical_features <span class="op">=</span> X.select_dtypes(include<span class="op">=</span><span class="st">&#39;category&#39;</span>).columns.tolist()</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>numerical_features <span class="op">=</span> X.select_dtypes(include<span class="op">=</span>[<span class="st">&#39;float64&#39;</span>, <span class="st">&#39;int64&#39;</span>]).columns.tolist()</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># preprocessing</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>preprocessor <span class="op">=</span> ColumnTransformer([</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;num&quot;</span>, StandardScaler(), numerical_features),</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;cat&quot;</span>, OneHotEncoder(handle_unknown<span class="op">=</span><span class="st">&quot;ignore&quot;</span>), categorical_features)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># data split</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, stratify<span class="op">=</span>y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code></pre></div>
</div>
<div id="dT4cIperrFEt" class="cell markdown" id="dT4cIperrFEt">
<p>Logistic Regression</p>
</div>
<div id="wbtYXROyrHES" class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="wbtYXROyrHES" data-outputId="13754573-d1cd-474c-8140-fd016499e709">
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>logreg_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;preprocessor&quot;</span>, preprocessor),</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;classifier&quot;</span>, LogisticRegression(max_iter<span class="op">=</span><span class="dv">1000</span>, class_weight<span class="op">=</span><span class="st">&quot;balanced&quot;</span>, random_state<span class="op">=</span><span class="dv">42</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>logreg_pipeline.fit(X_train, y_train)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>y_pred_logreg <span class="op">=</span> logreg_pipeline.predict(X_test)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>y_proba_logreg <span class="op">=</span> logreg_pipeline.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Logistic Regression Report&quot;</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_logreg))</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ROC AUC Score:&quot;</span>, roc_auc_score(y_test, y_proba_logreg))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Logistic Regression Report
              precision    recall  f1-score   support

           0       1.00      0.89      0.94    257834
           1       0.04      0.80      0.08      1501

    accuracy                           0.89    259335
   macro avg       0.52      0.84      0.51    259335
weighted avg       0.99      0.89      0.94    259335

ROC AUC Score: 0.92666870751586
</code></pre>
</div>
</div>
<div id="Hx97h4S6xQjR" class="cell markdown" id="Hx97h4S6xQjR">
<p>Logistic Regression - Confusion Matrix</p>
</div>
<div id="9809ZQM1xN3Z" class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="9809ZQM1xN3Z" data-outputId="2c24cf4d-5187-44dd-b0b5-e56f0c93719e">
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_confusion(y_true, y_pred, title):</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    cm <span class="op">=</span> confusion_matrix(y_true, y_pred)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    sns.heatmap(cm, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">&#39;d&#39;</span>, cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>                xticklabels<span class="op">=</span>[<span class="st">&#39;Not Fraud&#39;</span>, <span class="st">&#39;Fraud&#39;</span>],</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                yticklabels<span class="op">=</span>[<span class="st">&#39;Not Fraud&#39;</span>, <span class="st">&#39;Fraud&#39;</span>])</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Predicted&#39;</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Actual&#39;</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>plot_confusion(y_test, y_pred_logreg, <span class="st">&quot;Logistic Regression - Confusion Matrix&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/be727283deb7a9109b4f7efd2813590895162097.png" /></p>
</div>
</div>
<div id="9MPPJsByxT7Z" class="cell markdown" id="9MPPJsByxT7Z">
<p>Logistic Regression - ROC Curve</p>
</div>
<div id="_bDwbbBlxXOy" class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="_bDwbbBlxXOy" data-outputId="3f019e4e-5778-45ca-9d4c-fd1addfd4bec">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>fpr, tpr, thresholds <span class="op">=</span> roc_curve(y_test, y_proba_logreg)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr, tpr, color<span class="op">=</span><span class="st">&#39;darkorange&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f&#39;ROC Curve (AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">)&#39;</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], color<span class="op">=</span><span class="st">&#39;navy&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Logistic Regression - ROC Curve&#39;</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">&#39;lower right&#39;</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/de94d5f666dea2472b6f50f53eea490b16c08d52.png" /></p>
</div>
</div>
<div id="2KxQS2e1xntO" class="cell markdown" id="2KxQS2e1xntO">
<p>The Logistic Regression model performs well overall, achieving an
accuracy of 89% and an ROC AUC score of 0.93. This suggests strong
discriminative ability between fraudulent and non-fraudulent
transactions. However, the class imbalance is clearly evident in the
precision and recall metrics. While the model correctly identifies 80%
of actual fraud cases (high recall), its precision is only 4%, meaning
most of the fraud predictions are false positives. This is expected
behavior for a model optimized for recall in fraud detection. It is
supposed to prioritize catching as many fraudulent transactions as
possible, even if it means flagging the legitimate ones. This tradeoff
is often acceptable in real-world settings because failing to catch
fraud is more harmful than a false alarm.</p>
</div>
<div id="Iwa9R9KQrIN_" class="cell markdown" id="Iwa9R9KQrIN_">
<p>Random Forest Classifier</p>
</div>
<div id="_cGVAu0ErK9w" class="cell code" data-execution_count="27"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="_cGVAu0ErK9w" data-outputId="b26cb739-0289-4a09-c549-2285ad61a043">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> BernoulliNB</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>nb_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;preprocessor&quot;</span>, preprocessor),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;classifier&quot;</span>, BernoulliNB())</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>nb_pipeline.fit(X_train, y_train)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>y_pred_nb <span class="op">=</span> nb_pipeline.predict(X_test)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>y_proba_nb <span class="op">=</span> nb_pipeline.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Naive Bayes Report&quot;</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_nb))</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ROC AUC Score:&quot;</span>, roc_auc_score(y_test, y_proba_nb))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Naive Bayes Report
              precision    recall  f1-score   support

           0       0.99      1.00      1.00    257834
           1       1.00      0.03      0.05      1501

    accuracy                           0.99    259335
   macro avg       1.00      0.51      0.53    259335
weighted avg       0.99      0.99      0.99    259335

ROC AUC Score: 0.816137885627696
</code></pre>
</div>
</div>
<div id="FXmB47ZbyoWg" class="cell markdown" id="FXmB47ZbyoWg">
<p>Naive Bayes - Confusion Matrix</p>
</div>
<div id="oC_Npzjwyqd5" class="cell code" data-execution_count="28"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="oC_Npzjwyqd5" data-outputId="8f1457e4-5a45-42e7-f862-163e3443f33b">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plot_confusion(y_test, y_pred_nb, <span class="st">&quot;Naive Bayes - Confusion Matrix&quot;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/197b8818a76feeb84cb64c92658d4580333dbf7d.png" /></p>
</div>
</div>
<div id="aQKGAmGUyhe6" class="cell markdown" id="aQKGAmGUyhe6">
<p>Naive Bayes - ROC Curve</p>
</div>
<div id="onkdWWJuyfdO" class="cell code" data-execution_count="29"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="onkdWWJuyfdO" data-outputId="d741c429-dc81-43d9-937c-5b0687fca4e2">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fpr_nb, tpr_nb, _ <span class="op">=</span> roc_curve(y_test, y_proba_nb)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>roc_auc_nb <span class="op">=</span> auc(fpr_nb, tpr_nb)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_nb, tpr_nb, color<span class="op">=</span><span class="st">&#39;darkgreen&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f&#39;Naive Bayes (AUC = </span><span class="sc">{</span>roc_auc_nb<span class="sc">:.2f}</span><span class="ss">)&#39;</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], color<span class="op">=</span><span class="st">&#39;gray&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Naive Bayes - ROC Curve&#39;</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/2c894093bb545159950841839b1f564d31da6f5b.png" /></p>
</div>
</div>
<div id="G4UcuDDfy5-p" class="cell markdown" id="G4UcuDDfy5-p">
<p>The Naive Bayes classifier is an example of how high accuracy can
disguise poor performance in imbalanced classification problems. Though
the model has an overall accuracy of 99% and a ROC AUC score of 0.82, a
closer look shows that this performance is powered almost entirely by
its ability to correctly classify non-fraudulent transactions (which are
the majority of the dataset) The model achieves perfect precision for
fraud cases but has an extremely low recall of just 2.8%, which means it
detects only 42 out of 1,501 actual fraudulent transactions. The
confusion matrix confirms this imbalance. Almost all fraud cases go
undetected, while all legitimate transactions are confidently labeled as
non-fraud. In a fraud detection setting where catching fraud is the most
important, this behavior makes the model ineffective. While Naive Bayes
is computationally efficient and useful as a baseline, its assumptions
of independence and makes it poorly suited for critical and high stakes
applications like financial fraud prediction.</p>
</div>
<div id="a1a13ade" class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="a1a13ade" data-outputId="a1f3b817-b18b-46c0-9838-0ed04972642f">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>rf_pipeline <span class="op">=</span> Pipeline([</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;preprocessor&quot;</span>, preprocessor),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">&quot;classifier&quot;</span>, RandomForestClassifier(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        n_estimators<span class="op">=</span><span class="dv">50</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        max_depth<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        class_weight<span class="op">=</span><span class="st">&#39;balanced&#39;</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>rf_pipeline.fit(X_train, y_train)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>y_pred_rf <span class="op">=</span> rf_pipeline.predict(X_test)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>y_proba_rf <span class="op">=</span> rf_pipeline.predict_proba(X_test)[:, <span class="dv">1</span>]</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Random Forest Report&quot;</span>)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_rf))</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;ROC AUC Score:&quot;</span>, roc_auc_score(y_test, y_proba_rf))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Random Forest Report
              precision    recall  f1-score   support

           0       1.00      0.95      0.97    257834
           1       0.09      0.78      0.16      1501

    accuracy                           0.95    259335
   macro avg       0.54      0.86      0.57    259335
weighted avg       0.99      0.95      0.97    259335

ROC AUC Score: 0.9313290003607515
</code></pre>
</div>
</div>
<div id="a13efa88" class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:564}"
id="a13efa88" data-outputId="8bd6f98b-595c-42dd-f1ac-ec977f4c5473">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>fpr_lr, tpr_lr, _ <span class="op">=</span> roc_curve(y_test, y_proba_logreg)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>fpr_nb, tpr_nb, _ <span class="op">=</span> roc_curve(y_test, y_proba_nb)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>fpr_rf, tpr_rf, _ <span class="op">=</span> roc_curve(y_test, y_proba_rf)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_lr, tpr_lr, label<span class="op">=</span><span class="st">&#39;Logistic Regression&#39;</span>)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_nb, tpr_nb, label<span class="op">=</span><span class="st">&#39;Naive Bayes&#39;</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>plt.plot(fpr_rf, tpr_rf, label<span class="op">=</span><span class="st">&#39;Random Forest&#39;</span>)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>, color<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;False Positive Rate&#39;</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;True Positive Rate&#39;</span>)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;ROC Curves for All Models&#39;</span>)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/9cb655c8cb709dbd30e22bf09eee0debea1538d1.png" /></p>
</div>
</div>
<div id="b9374ef7" class="cell code" data-execution_count="32"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:487}"
id="b9374ef7" data-outputId="68a16662-a203-436f-9f1d-4a7f4ea88b90">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>rf_model <span class="op">=</span> rf_pipeline.named_steps[<span class="st">&#39;classifier&#39;</span>]</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> preprocessor.get_feature_names_out()</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>importances <span class="op">=</span> rf_model.feature_importances_</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>top_feats <span class="op">=</span> pd.Series(importances, index<span class="op">=</span>feature_names).nlargest(<span class="dv">15</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>top_feats.plot(kind<span class="op">=</span><span class="st">&#39;barh&#39;</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Random Forest Feature Importances&quot;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Importance Score&quot;</span>)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_e114814f0c724cd9b38e8c4528ae8f67/04c3e2f640d2ede9bfa20ec032398b93d3c7136f.png" /></p>
</div>
</div>
<div id="0bb1e0e4" class="cell markdown" id="0bb1e0e4">
<h2 id="conclusion"><strong>Conclusion</strong></h2>
</div>
<div id="d0ea56ee" class="cell markdown" id="d0ea56ee">
<h3 id="project-recap">Project Recap</h3>
<p>This project aimed to detect fraudulent credit card transactions by
analyzing a real-world dataset using both statistical hypothesis testing
and machine learning techniques. We wanted to understand <strong>what
features signal fraud</strong> and <strong>how predictive models can
automate fraud detection</strong>.</p>
<hr />
<h3 id="insights-from-analysis">Insights from Analysis</h3>
<p>From our exploratory data analysis, we observed that fraudulent
transactions only comprise a small portion of total transactions, and
tend to cluster tightly around a higher range of purchase amounts. This
indicated that transaction value was a strong predictive feature, which
we later confirmed in the Random Forest feature importance plot. During
our analysis of merchant category against fraud occurrence, we observed
that grocery_pos, shopping_net, and misc_net to be the leading
categories. In our Random Forest feature importance plot, we found
shopping_net to be the second most important feature in predicting
fraud.</p>
<p>We explored the relationship between transaction amounts and age
groups, where we found a statistically significant difference in the
average transcation amount across age groups. Ages 25 to 44 show a
slightly higher median spending, suggesting that middle-aged customers
potentially have larger transactions on average compared to other ages.
This is an interesting finding, as we found in our importance plot that
transaction amount was the strongest predictive feature in fraud
occurrence. However, age itself did not appear as a strong predictor in
the model. This contrast suggests a potential indirect relationship, as
age may influence transaction amount, which in turn impacts fraud risk,
even if age alone isn't directly predictive. Based on our EDA, one might
expect age to have stronger predictive value, so future modeling efforts
could explore interaction terms or non-linear relationships between age
and transaction features to better capture this influence.</p>
<p>During our exploratory data analysis (EDA), we also examined spending
differences between sexes and analyzed transaction amounts in relation
to city population. While these investigations did not directly
contribute to our primary thematic focus on fraud detection, they
provided valuable context and helped us better understand underlying
behavioral and demographic patterns in the data.</p>
<hr />
<h3 id="machine-learning-summary">Machine Learning Summary</h3>
<p>We trained and compared <strong>three classifiers</strong>:</p>
<ul>
<li><strong>Logistic Regression</strong></li>
<li><strong>Naive Bayes</strong></li>
<li><strong>Random Forest</strong></li>
</ul>
<p>Our analysis shows that both Logistic Regression and Random Forest
models perform well, with ROC AUC scores of ~0.93, indicating strong
ability to classify fraudulent and non-fraudulent transactions. Logistic
Regression achieves high recall for fraud (80%), but does so at the cost
of very low precision (4%), meaning it flags many legitimate
transactions as fraud. Random Forest slightly improves precision (9%)
while maintaining a similar recall (78%) and higher overall accuracy
(95%). Feature importance analysis from the Random Forest model reveals
that transaction amount is by far the most influential factor, followed
by certain transaction categories like online shopping. Although Naive
Bayes performs the worst of all models (ROC AUC = 0.82), the models
overall highlight the effectiveness of using transaction features for
fraud detection.</p>
<hr />
<h3 id="practical-implications">Practical Implications</h3>
<p>Our machine learning models have several practical implications.
Logistic Regression and Random Forest demonstrated success in
identifying large amounts of fraudulent transactions, which is critical
for both financial providers and ordinary customers to minimize
financial loss. Although the models catch many fraud cases, they also
generate a high number of false positives-- especially Logistic
Regression. Thus, Random Forest, while slightly more complex than
Logistic Regression, offers better fraud detection precision and a
strong recall.</p>
<hr />
<h3 id="limitations--future-work">Limitations &amp; Future Work</h3>
<p>A key limitation of this study, as seen in the EDA, is the clear
class imbalance between fraudulent and legitimate transactions. This
skews the models toward predicting non-fraud more often, resulting in
low precision—many false positives—even when recall is high. Another
limitation is that the our models rely on a static set of features and
do not consider time-related patterns or transaction sequences, which
are often critical in real-world fraud detection. For instance, multiple
repeated transactions or geographic inconsistencies could indicate a
greater chance of fraud. In the future, integrating temporal and
geographical features could improve model performance.</p>
<hr />
</div>
</body>
</html>
